<!DOCTYPE html>
<html>

<head>
    <title>Image Classifier</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
</head>

<body>
    <h1 class="text-center">Image Classifier</h1>


    <form class="p-3 text-center" action='/' , method="post" enctype="multipart/form-data">

        <div class="p-3 text-center">
            <div id="drop-zone" style="border: 2px dashed #ccc; padding: 20px;">
                <p>Drag and drop an image here or click to select one.</p>
                <input type="file" name="imagefile" id="imagefile" accept="image/*" onchange="handleFileSelect(event);">
            </div>
        </div>
        <input class="btn btn-primary mt-3" type="submit" value="Predict Image">
    </form>

    <img id="preview-image" style="display: none; max-width: 100%; max-height: 400px; margin-top: 20px;">

    <script>
        const dropZone = document.getElementById("drop-zone");
        const imageFileInput = document.getElementById("imagefile");
        const previewImage = document.getElementById("preview-image");

        dropZone.addEventListener("dragover", (e) => {
            e.preventDefault();
            dropZone.style.border = "2px dashed #000";
        });

        dropZone.addEventListener("dragleave", () => {
            dropZone.style.border = "2px dashed #ccc";
        });

        dropZone.addEventListener("drop", (e) => {
            e.preventDefault();
            dropZone.style.border = "2px dashed #ccc";
            const files = e.dataTransfer.files;

            if (files.length > 0) {
                const file = files[0];
                if (file.type.startsWith("image/")) {
                    imageFileInput.files = files;
                    handleFileSelect(null);
                } else {
                    alert("Please drop an image file.");
                }
            }
        });

        function handleFileSelect(event) {
            const file = event ? event.target.files[0] : imageFileInput.files[0];
            if (file.type.startsWith("image/")) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewImage.src = e.target.result;
                    previewImage.style.display = "block";
                };
                reader.readAsDataURL(file);
            } else {
                alert("Please select an image file.");
            }
        }
    </script>


    {% if prediction %}
    <p class="text-center">Image is a {{prediction}}</p>
    {% endif %}
</body>

</html>